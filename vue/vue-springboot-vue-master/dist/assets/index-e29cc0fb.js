import{d as le,r as c,J as v,o as oe,a as h,c as ae,k as M,a4 as e,w as t,f as a,aw as ne,a2 as s,O as se,l as V,ac as C,a6 as k,al as ie,ay as re,az as de}from"./index-6e278e4c.js";import{e as ue,f as pe,_ as _e,a as me,b as ce,E as fe,g as ge,c as be,d as ye,v as ve}from"./search-cb33e234.js";import{E as he}from"./el-dialog-7225b063.js";import{E as ke,a as we}from"./el-radio-86a5f7d7.js";import{E as Ee}from"./el-input-number-eaf8393a.js";import"./el-tooltip-fc220203.js";import"./el-tree-2d203f22.js";import{E as Ve}from"./el-tree-select-36b1753f.js";import{E as Ce}from"./el-card-e6cdcab0.js";import{_ as xe}from"./plus-791a9653.js";/* empty css                */import{E as x,a as De}from"./el-form-item-490b18bc.js";import{l as Ie,g as Fe,u as Be,a as Te,d as Ue,b as qe}from"./index-5556a057.js";import"./refs-4b7a3a14.js";import"./index-d06f9fa4.js";import"./castArray-5e585c79.js";const Oe={class:"app-container"},Re={class:"search"},Se={class:"dialog-footer"},$e={name:"dept"},tt=le({...$e,setup(ze){const D=c(x),g=c(x),p=c(!1),w=c([]),d=v({visible:!1}),_=v({}),I=c(),F=c(),n=v({status:1,parentId:0,sort:1}),N=v({parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function m(){p.value=!0,Ie(_).then(({data:i})=>{I.value=i,p.value=!1})}function B(){D.value.resetFields(),m()}function K(i){w.value=i.map(l=>l.id)}async function j(){qe().then(i=>{F.value=[{value:0,label:"顶级部门",children:i.data}]})}async function E(i,l){await j(),d.visible=!0,l?(d.title="修改部门",Fe(l).then(({data:y})=>{Object.assign(n,y)})):(d.title="新增部门",n.parentId=i??0)}function L(){g.value.validate(i=>{if(i){const l=n.id;p.value=!0,l?Be(l,n).then(()=>{k.success("修改成功"),b(),m()}).finally(()=>p.value=!1):Te(n).then(()=>{k.success("新增成功"),b(),m()}).finally(()=>p.value=!1)}})}function T(i){const l=[i||w.value].join(",");if(!l){k.warning("请勾选删除项");return}ie.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ue(l).then(()=>{k.success("删除成功"),B()})})}function b(){d.visible=!1,Q()}function Q(){g.value.resetFields(),g.value.clearValidate(),n.id=void 0,n.parentId=0,n.status=1,n.sort=1}return oe(()=>{m()}),(i,l)=>{const y=re,u=De,U=ue,G=pe,J=_e,r=de,P=me,q=x,O=xe,R=ce,f=fe,S=ge,A=be,H=ye,W=Ce,X=Ve,Y=Ee,$=ke,Z=we,ee=he,te=ve;return h(),ae("div",Oe,[M("div",Re,[e(q,{ref_key:"queryFormRef",ref:D,model:a(_),inline:!0},{default:t(()=>[e(u,{label:"关键字",prop:"keywords"},{default:t(()=>[e(y,{modelValue:a(_).keywords,"onUpdate:modelValue":l[0]||(l[0]=o=>a(_).keywords=o),placeholder:"部门名称",onKeyup:ne(m,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(u,{label:"部门状态",prop:"status"},{default:t(()=>[e(G,{modelValue:a(_).status,"onUpdate:modelValue":l[1]||(l[1]=o=>a(_).status=o),placeholder:"部门状态",clearable:""},{default:t(()=>[e(U,{value:1,label:"正常"}),e(U,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(r,{class:"filter-item",type:"primary",onClick:m},{default:t(()=>[e(J),s(" 搜索 ")]),_:1}),e(r,{onClick:B},{default:t(()=>[e(P),s("重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),e(W,null,{header:t(()=>[e(r,{type:"success",onClick:l[2]||(l[2]=o=>E(0,void 0))},{default:t(()=>[e(O),s("新增")]),_:1}),e(r,{type:"danger",onClick:l[3]||(l[3]=o=>T()),disabled:a(w).length===0},{default:t(()=>[e(R),s("删除 ")]),_:1},8,["disabled"])]),default:t(()=>[se((h(),V(H,{data:a(I),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:K},{default:t(()=>[e(f,{type:"selection",width:"55",align:"center"}),e(f,{prop:"name",label:"部门名称","min-width":"200"}),e(f,{prop:"status",label:"状态",width:"100"},{default:t(o=>[o.row.status==1?(h(),V(S,{key:0,type:"success"},{default:t(()=>[s("正常")]),_:1})):(h(),V(S,{key:1,type:"info"},{default:t(()=>[s("禁用")]),_:1}))]),_:1}),e(f,{prop:"sort",label:"排序",width:"100"}),e(f,{label:"操作",fixed:"right",align:"left",width:"200"},{default:t(o=>[e(r,{type:"primary",link:"",size:"small",onClick:C(z=>E(o.row.id,void 0),["stop"])},{default:t(()=>[e(O),s("新增 ")]),_:2},1032,["onClick"]),e(r,{type:"primary",link:"",size:"small",onClick:C(z=>E(o.row.parentId,o.row.id),["stop"])},{default:t(()=>[e(A),s("编辑 ")]),_:2},1032,["onClick"]),e(r,{type:"primary",link:"",size:"small",onClick:C(z=>T(o.row.id),["stop"])},{default:t(()=>[e(R),s("删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,a(p)]])]),_:1}),e(ee,{title:a(d).title,modelValue:a(d).visible,"onUpdate:modelValue":l[8]||(l[8]=o=>a(d).visible=o),width:"600px",onClosed:b},{footer:t(()=>[M("div",Se,[e(r,{type:"primary",onClick:L},{default:t(()=>[s(" 确 定 ")]),_:1}),e(r,{onClick:b},{default:t(()=>[s(" 取 消 ")]),_:1})])]),default:t(()=>[e(q,{ref_key:"deptFormRef",ref:g,model:a(n),rules:a(N),"label-width":"80px"},{default:t(()=>[e(u,{label:"上级部门",prop:"parentId"},{default:t(()=>[e(X,{modelValue:a(n).parentId,"onUpdate:modelValue":l[4]||(l[4]=o=>a(n).parentId=o),placeholder:"选择上级部门",data:a(F),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),e(u,{label:"部门名称",prop:"name"},{default:t(()=>[e(y,{modelValue:a(n).name,"onUpdate:modelValue":l[5]||(l[5]=o=>a(n).name=o),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),e(u,{label:"显示排序",prop:"sort"},{default:t(()=>[e(Y,{modelValue:a(n).sort,"onUpdate:modelValue":l[6]||(l[6]=o=>a(n).sort=o),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])]),_:1}),e(u,{label:"部门状态"},{default:t(()=>[e(Z,{modelValue:a(n).status,"onUpdate:modelValue":l[7]||(l[7]=o=>a(n).status=o)},{default:t(()=>[e($,{label:1},{default:t(()=>[s("正常")]),_:1}),e($,{label:0},{default:t(()=>[s("禁用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{tt as default};
